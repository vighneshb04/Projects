"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.customJwt = customJwt;
const fetchers_js_1 = require("../../native/helpers/api/fetchers.js");
const constants_js_1 = require("../../native/helpers/constants.js");
const errors_js_1 = require("../../native/helpers/errors.js");
async function customJwt(args) {
    const resp = await fetch(constants_js_1.ROUTE_AUTH_JWT_CALLBACK, {
        method: "POST",
        headers: {
            ...(0, fetchers_js_1.getSessionHeaders)(),
        },
        body: JSON.stringify({
            jwt: args.jwt,
            developerClientId: args.client.clientId,
        }),
    });
    if (!resp.ok) {
        const error = await resp.json();
        throw new Error(`JWT authentication error: ${error.message}`);
    }
    try {
        const { verifiedToken } = await resp.json();
        return { storedToken: verifiedToken };
    }
    catch (e) {
        throw new Error((0, errors_js_1.createErrorMessage)("Malformed response from post jwt authentication", e));
    }
}
//# sourceMappingURL=jwt.js.map